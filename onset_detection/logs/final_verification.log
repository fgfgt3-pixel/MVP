2025-10-01 14:50:01,925 - __main__ - INFO - Loading config from: onset_detection/config/onset_default.yaml
2025-10-01 14:50:01,927 - __main__ - INFO - Initializing onset detection pipeline
2025-10-01 14:50:01,936 - __main__ - INFO - Loading data from: D:\OneDrive - HKNC\D drive\Data cleansing\cleaned\023790_44indicators_realtime_20250901_clean.csv
2025-10-01 14:50:02,255 - __main__ - INFO - Loaded 58810 rows from D:\OneDrive - HKNC\D drive\Data cleansing\cleaned\023790_44indicators_realtime_20250901_clean.csv
2025-10-01 14:50:02,255 - __main__ - INFO - Generating features from clean data
2025-10-01 14:50:02,270 - __main__ - ERROR - Unexpected error: 'ts'
Traceback (most recent call last):
  File "C:\Users\HANTA\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'ts'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\MVP\scripts\step03_detect.py", line 221, in main
    features_df = load_data(args.input, generate_features=args.generate_features)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\MVP\scripts\step03_detect.py", line 81, in load_data
    features_df = calculate_core_indicators(df)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\MVP\onset_detection\src\features\core_indicators.py", line 196, in calculate_core_indicators
    return calculator.add_indicators(df)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\MVP\onset_detection\src\features\core_indicators.py", line 51, in add_indicators
    result_df = self._add_timestamp_features(result_df)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\MVP\onset_detection\src\features\core_indicators.py", line 70, in _add_timestamp_features
    if pd.api.types.is_datetime64_any_dtype(df['ts']):
                                            ~~^^^^^^
  File "C:\Users\HANTA\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HANTA\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'ts'
